<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <title>Liturgical Services</title>
    <!-- Bootstrap 5 CSS -->
    <link href="./_assets/bootstrap@5.3.8/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="./_assets/bootstrap-icons@1.13.1/font/bootstrap-icons.min.css" rel="stylesheet">
    <link href="./_assets/bootstrap-icons@1.13.1/font/bootstrap-icons.woff" rel="stylesheet">
    <link href="./_assets/bootstrap-icons@1.13.1/font/bootstrap-icons.woff2" rel="stylesheet">
    <!-- <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/fonts/bootstrap-icons.woff" rel="stylesheet">
<link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/fonts/bootstrap-icons.woff2" rel="stylesheet"> -->
    <style>
        /* Custom styling to make the input look like a button/icon if desired */
    	#hiddenDatePicker {
    		position: absolute;
    		width: 0;
    		height: 0;
    		opacity: 0;
    		pointer-events: none;
    	}
        .date-container {
            text-align: center;
        }
        #selectedDate {
            margin-top: 15px;
            font-weight: bold;
            font-size: 1.2rem;
        }
    	.calendar-icon-btn:hover {
    		color: #007bff;
    	}
    	.calendar-icon-btn {
    		font-size: 1.5rem;
    		cursor: pointer;
    		transition: color: 0.2s;
    	} 
        .vh-center {
            min-height: 40vh;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
    	.font-medium {
        	font-family: sans-serif;
        	font-size: 1.455rem;
        	font-weight: 500;
    	}
    </style>
</head>
<body class="bg-light">

    <div class="container my-4">

    <h1 class="text-center mb-4">Liturgical Services</h1>

    <!-- Controls -->
    <div class="row g-3 mb-4">
        <div class="col-12 col-md-6">
        <select id="year" class="form-select"></select>
        </div>
        <div class="col-12 col-md-6">
        <select id="month" class="form-select"></select>
        </div>
    </div>

    <!-- List -->
    <div id="list" class="list-group"></div>

    </div>

    
    <script>
        const MONTHS = [
        "January","February","March","April","May","June",
        "July","August","September","October","November","December"
        ];

        const yearSelect = document.getElementById("year");
        const monthSelect = document.getElementById("month");
        const list = document.getElementById("list");

        let feasts = [];

        function initSelectors(data) {
        const years = [...new Set(data.map(f => f.date.slice(0,4)))].sort();

        years.forEach(y => {
            yearSelect.add(new Option(y, y));
        });

        MONTHS.forEach((m, i) => {
            monthSelect.add(new Option(m, String(i + 1).padStart(2, "0")));
        });

        const now = new Date();
        yearSelect.value = String(now.getFullYear());
        monthSelect.value = String(now.getMonth() + 1).padStart(2, "0");
        }

        function render() {
        list.innerHTML = "";

        const y = yearSelect.value;
        const m = monthSelect.value;

        const filtered = feasts.filter(f =>
            f.date.startsWith(`${y}-${m}`)
        );

        filtered.forEach(f => {
            const day = f.date.slice(8,10);
            const monthName = MONTHS[Number(m) - 1];

            const a = document.createElement("a");
            a.href = f.file;
            a.target = "_blank";
            a.className = "list-group-item list-group-item-action py-3";
            a.innerHTML = `
            <strong>${monthName} ${day}</strong><br>
            <span class="text-muted">${f.title}</span>
            `;

            list.appendChild(a);
        });
        }

        fetch("Service_Texts/_system/feasts.json")
        .then(r => r.json())
        .then(data => {
            feasts = data;
            initSelectors(feasts);
            render();
        });

        yearSelect.addEventListener("change", render);
        monthSelect.addEventListener("change", render);
    </script>

    </body>
</html>
